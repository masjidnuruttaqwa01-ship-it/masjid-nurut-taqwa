<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Display Masjid Nurut Taqwa</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:Poppins,sans-serif;
  background:#000;
  overflow:hidden;
  color:#fff;
}

/* ===== BACKGROUND SLIDESHOW FULL SCREEN ===== */
.slideshow{
  position:fixed;
  inset:0;
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  transition:opacity 1.5s ease;
  z-index:0;
  opacity:0;
}

/* ===== OVERLAY CONTAINER ===== */
.overlay{
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  z-index:5;
}

/* ===== HEADER PREMIUM GLASS ===== */
.header{
  height:90px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 40px;
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(20px);
  border-bottom:1px solid rgba(255,255,255,.25);
}

.header b{
  font-size:30px;
  font-weight:700;
  color:#fff;
}

.clock{
  font-size:48px;
  font-weight:700;
  color:#fff;
}

/* ===== TANGGAL ===== */
.info{
  text-align:center;
  padding:10px 0;
  font-size:18px;
  background:rgba(255,255,255,0.10);
  backdrop-filter:blur(15px);
}

/* ===== VIDEO AREA ===== */
.video-area{
  flex:1;
  position:relative;
}

.video-area iframe{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:0;
  z-index:1;
}

/* ===== JADWAL SHOLAT GLASS ===== */
.sholat-bottom{
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(20px);
  padding:18px 25px;
}

.sholat-bar{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(110px,1fr));
  gap:14px;
}

.sholat{
  background:rgba(255,255,255,.25);
  border-radius:20px;
  padding:15px 10px;
  text-align:center;
  font-size:16px;
  color:#fff;
  backdrop-filter:blur(8px);
}

.sholat b{
  display:block;
  font-size:24px;
  margin-top:6px;
}

.sholat.active{
  background:#f59e0b;
  box-shadow:0 0 25px rgba(245,158,11,.8);
}

/* ===== RUNNING TEXT ===== */
.marquee{
  height:48px;
  display:flex;
  align-items:center;
  background:rgba(0,0,0,.6);
  overflow:hidden;
}

.marquee span{
  white-space:nowrap;
  padding-left:100%;
  animation:marquee 25s linear infinite;
  font-size:20px;
}

@keyframes marquee{
  from{transform:translateX(0)}
  to{transform:translateX(-100%)}
}

/* ===== VIDEO MODE ===== */
.mode-video .slideshow{opacity:0}
.mode-video iframe{opacity:1}

/* ===== WALLPAPER MODE ===== */
.mode-wallpaper .slideshow{opacity:1}
.mode-wallpaper iframe{opacity:0;pointer-events:none}
</style>
</head>

<body>

<div class="slideshow" id="slideshow"></div>

<div class="overlay">

<div class="header">
  <b>ðŸ•Œ Masjid Nurut Taqwa</b>
  <div class="clock" id="clock">00:00</div>
</div>

<div class="info">
  <div id="tanggal"></div>
  <div id="hijriah"></div>
</div>

<div class="video-area">
  <iframe id="haramainVideo"
    src="https://www.youtube.com/embed/qvTI4bKqucs?autoplay=1&mute=1&controls=0&rel=0&playsinline=1"
    allow="autoplay; encrypted-media"
    allowfullscreen></iframe>
</div>

<div class="sholat-bottom">
  <div class="sholat-bar" id="sholatBar"></div>
</div>

<div class="marquee">
  <span>Selamat datang di Masjid Nurut Taqwa â€¢ Scan QR untuk donasi â€¢ Ikuti kajian rutin setiap Jumat malam</span>
</div>

</div>

<script>
/* ===============================
   JAM & TANGGAL
================================ */
function updateClock(){
  clock.innerText=new Date().toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"});
}
setInterval(updateClock,1000);updateClock();

tanggal.innerText=new Date().toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});
hijriah.innerText=new Date().toLocaleDateString("id-ID-u-ca-islamic",{day:"numeric",month:"long",year:"numeric"})+" H";

/* ===============================
   JADWAL SHOLAT API
================================ */
fetch("https://api.aladhan.com/v1/timingsByCity?city=Cirebon&country=Indonesia&method=20")
.then(r=>r.json())
.then(res=>{
  const t=res.data.timings;
  const list=[
  ["Imsak",t.Imsak],
  ["Subuh",t.Fajr],
  ["Terbit",t.Sunrise],
  ["Dhuha", tambahMenit(t.Sunrise,20)],
  ["Dzuhur",t.Dhuhr],
  ["Ashar",t.Asr],
  ["Maghrib",t.Maghrib],
  ["Isya",t.Isha]
];
  sholatBar.innerHTML=list.map(s=>`
    <div class="sholat">${s[0]}<b>${s[1]}</b></div>
  `).join("");
});
function tambahMenit(waktu, menit){
  let [jam, mnt] = waktu.split(":").map(Number);
  let total = jam * 60 + mnt + menit;
  let h = Math.floor(total / 60) % 24;
  let m = total % 60;
  return h.toString().padStart(2,"0") + ":" + 
         m.toString().padStart(2,"0");
}
/* ===============================
   SUPABASE WALLPAPER SYSTEM
================================ */
const SUPABASE_URL="https://xntiicnhmhgpujeekmxt.supabase.co";
const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhudGlpY25obWhncHVqZWVrbXh0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1OTI5MzgsImV4cCI6MjA4NDE2ODkzOH0.JAIAnUgflSHE1oEQ8pKyWk_3F283oh4kiemSumwC-cU";
const sb=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY);

let wallpapers=[];
let index=0;

async function loadWallpapers(){
  const {data}=await sb.storage.from("wallpaper").list("",{limit:100});
  wallpapers=data
    .filter(f=>/\.(jpg|jpeg|png|webp)$/i.test(f.name))
    .map(f=>`${SUPABASE_URL}/storage/v1/object/public/wallpaper/${f.name}`);
  if(wallpapers.length){
    slideshow.style.backgroundImage=`url('${wallpapers[0]}')`;
  }
}

function nextWallpaper(){
  if(!wallpapers.length)return;
  index=(index+1)%wallpapers.length;
  slideshow.style.backgroundImage=`url('${wallpapers[index]}')`;
}

/* ===============================
   MODE VIDEO â†” WALLPAPER
================================ */
function showVideo(){
  document.body.classList.add("mode-video");
  document.body.classList.remove("mode-wallpaper");
  setTimeout(showWallpaper,60000); // 1 menit video
}

function showWallpaper(){
  document.body.classList.add("mode-wallpaper");
  document.body.classList.remove("mode-video");
  setTimeout(showVideo,60000); // 1 menit slideshow
}

loadWallpapers().then(()=>{
  setInterval(nextWallpaper,8000); // ganti 8 detik
  showVideo();
});

/* ===============================
   UNMUTE SEKALI KLIK
================================ */
document.addEventListener("click",()=>{
  const v=document.getElementById("haramainVideo");
  v.src=v.src.replace("mute=1","mute=0");
},{once:true});
</script>
<script>
/* ===== AUTO FULLSCREEN SAAT KLIK ===== */
document.addEventListener("click", function () {

  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen().catch(err => {
      console.log("Fullscreen gagal:", err);
    });
  }

}, { once: true });
</script>
  
</body>
</html>
