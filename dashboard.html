<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard DKM | Masjid Nurut Taqwa</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Poppins,sans-serif;
  background:linear-gradient(135deg,#064e3b,#0f766e);
  color:#fff;
}

/* HEADER */
.header{
  padding:20px;
  background:rgba(0,0,0,.25);
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.header h1{margin:0;font-size:20px;}
.logout{
  background:#dc2626;
  border:none;
  color:white;
  padding:10px 18px;
  border-radius:10px;
  font-weight:600;
}

/* CONTAINER */
.container{
  padding:22px;
  max-width:1100px;
  margin:auto;
}

/* INFO CARDS */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:16px;
}
.card{
  background:white;
  color:#064e3b;
  border-radius:16px;
  padding:18px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
.card h3{font-size:12px;opacity:.7;margin:0;}
.card .value{font-size:26px;font-weight:700}

/* FORM */
.form-box{
  background:white;
  color:#064e3b;
  border-radius:18px;
  padding:20px;
  margin:30px 0;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
}
.form-box h3{text-align:center;margin-bottom:14px;}
.form-box input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-bottom:12px;
}
.form-box input[type=file]{
  border:2px dashed #0f766e;
}
.form-box button{
  width:100%;
  background:#064e3b;
  color:white;
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:700;
}

/* TABLE */
.table{
  background:white;
  color:#064e3b;
  border-radius:18px;
  overflow:hidden;
}
table{
  width:100%;
  border-collapse:collapse;
}
th{
  background:#064e3b;
  color:white;
  padding:12px;
}
td{
  padding:10px;
  border-bottom:1px solid #eee;
  font-size:14px;
}

/* FOTO */
.bukti{
  width:50px;
  height:50px;
  border-radius:10px;
  object-fit:cover;
  cursor:pointer;
}
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.8);
  display:flex;
  align-items:center;
  justify-content:center;
}
.modal img{
  max-width:90%;
  max-height:90%;
  border-radius:20px;
  box-shadow:0 0 40px black;
}
</style>
</head>

<body>

<script>
if(localStorage.getItem("login")!=="true"){
  window.location="login.html";
}
</script>

<div class="header">
  <h1>Masjid Nurut Taqwa â€“ Dashboard Keuangan</h1>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="container">

<div class="cards">
  <div class="card"><h3>Saldo Kas</h3><div class="value" id="saldo">Rp 0</div></div>
  <div class="card"><h3>Pemasukan</h3><div class="value" id="inTotal">Rp 0</div></div>
  <div class="card"><h3>Pengeluaran</h3><div class="value" id="outTotal">Rp 0</div></div>
  <div class="card"><h3>Total Transaksi</h3><div class="value" id="count">0</div></div>
</div>

<div class="form-box">
<h3>Tambah Transaksi</h3>
<input type="date" id="tgl">
<input type="text" id="ket" placeholder="Keterangan">
<input type="number" id="masuk" placeholder="Pemasukan (Rp)">
<input type="number" id="keluar" placeholder="Pengeluaran (Rp)">
<input type="file" id="bukti">
<button onclick="simpan()">Simpan</button>
</div>

<div class="table">
<table id="tabel">
<tr>
  <th>Tanggal</th><th>Keterangan</th><th>Masuk</th><th>Keluar</th><th>Bukti</th>
</tr>
</table>
</div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("kas")||"[]");

function simpan(){
  const tgl=tglInput.value;
  const ket=ketInput.value;
  const masukVal=parseInt(masukInput.value||0);
  const keluarVal=parseInt(keluarInput.value||0);
  const file=bukti.files[0];

  if(!tgl||!ket)return alert("Lengkapi data");

  if(file){
    const r=new FileReader();
    r.onload=()=>{
      data.push({tgl,ket,masuk:masukVal,keluar:keluarVal,foto:r.result});
      save();
    };
    r.readAsDataURL(file);
  }else{
    data.push({tgl,ket,masuk:masukVal,keluar:keluarVal});
    save();
  }
}

function save(){
  localStorage.setItem("kas",JSON.stringify(data));
  render();
}

function render(){
  let saldo=0, masukT=0, keluarT=0;
  tabel.innerHTML="<tr><th>Tanggal</th><th>Keterangan</th><th>Masuk</th><th>Keluar</th><th>Bukti</th></tr>";
  data.forEach(x=>{
    saldo+=x.masuk-x.keluar;
    masukT+=x.masuk;
    keluarT+=x.keluar;
    tabel.innerHTML+=`
      <tr>
        <td>${x.tgl}</td>
        <td>${x.ket}</td>
        <td>${x.masuk? "Rp "+x.masuk.toLocaleString():"-"}</td>
        <td>${x.keluar? "Rp "+x.keluar.toLocaleString():"-"}</td>
        <td>${x.foto?`<img src="${x.foto}" class="bukti" onclick="view('${x.foto}')">`:""}</td>
      </tr>`;
  });
  saldo.textContent="Rp "+saldo.toLocaleString();
  inTotal.textContent="Rp "+masukT.toLocaleString();
  outTotal.textContent="Rp "+keluarT.toLocaleString();
  count.textContent=data.length;
}

function view(src){
  const m=document.createElement("div");
  m.className="modal";
  m.onclick=()=>m.remove();
  const i=document.createElement("img");
  i.src=src;
  m.appendChild(i);
  document.body.appendChild(m);
}

function logout(){
  localStorage.removeItem("login");
  location="login.html";
}

render();
</script>

</body>
</html>
